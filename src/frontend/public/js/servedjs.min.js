/*!
 * MIT License
 *
 * Copyright (c) 2017-2020 Imre Tabur <imre.tabur@eesti.ee>
 */
"use strict";!function(t){for(var e,n=t.jsdi=t.jsdi||{},o=(n.service("$log",function(){var t={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5,ALL:6,currentLevel:0,setLevel:function(e){t.levelIsInRange(e)&&(t.currentLevel=e)},levelIsInRange:function(e){return t.OFF<=e&&e<=t.ALL},shouldLog:function(e){return e<=t.currentLevel},error:function(){console&&t.shouldLog(t.ERROR)&&console.error.apply(console,arguments)},warn:function(){console&&t.shouldLog(t.WARN)&&console.warn.apply(console,arguments)},info:function(){console&&t.shouldLog(t.INFO)&&console.info.apply(console,arguments)},log:function(){console&&t.shouldLog(t.INFO)&&console.log.apply(console,arguments)},debug:function(){console&&t.shouldLog(t.DEBUG)&&console.log.apply(console,arguments)},trace:function(){console&&t.shouldLog(t.TRACE)&&console.trace.apply(console,arguments)}};return t}),n.service("$browser",function(){var e={init:function(){},forward:function(){t&&t.history.forward()},back:function(){t&&t.history.back()},go:function(e){t&&("number"==typeof e?t.history.go(e):t.location.hash="#"+e)}};return e}),function(e){e={storage:e,get:function(e){if(e){e=this.storage.getItem(e);if(e)return JSON.parse(e)}return null},set:function(e,t){e&&t&&this.storage.setItem(e,JSON.stringify(t))},removeItem:function(e){e&&this.storage.removeItem(e)}};return e}),i=[{globalName:"_",serviceName:"$lodash"},{globalName:"S",serviceName:"$strings"}],r=0;r<i.length;r++)t[(e=i[r]).globalName]&&n.service(e.serviceName,t[e.globalName]);n.service("$localStorage",o(localStorage)),n.service("$sessionStorage",o(sessionStorage)),n.service("$placeholders",function(){return{replace:function(e,t){var n,o;if(e&&t)for(n in t)o=new RegExp("\\$\\{"+n+"\\}","g"),e=e.replace(o,t[n]);return e}}}),n.service("$timer",function(){return{newTimer:function(e,t){return{millis:t,timer:null,start:function(){this.timer=setTimeout(e,this.millis)},stop:function(){clearTimeout(this.timer)}}},newInterval:function(e,t){return{millis:t,timer:null,start:function(){this.timer=setInterval(e,this.millis)},stop:function(){clearTimeout(this.timer)}}}}}),n.service("$router",function(){return{data:null,callback:null,configure:function(e){!e||this.callback||"function"!=typeof e&&"object"!==ypeof(e)||this.configureFunction(e)},configureFunction:function(e){this.callback=e;var t=this;window.addEventListener("hashchange",function(){t.process()},!1)},configureObject:function(e){var t=this;this.callbackObject=e,this.configureFunction(function(e){t.handleRouting(e)})},handleRouting:function(e){for(var t,n,o=this.callbackObject.routes,i=0;i<o.length;i++)if(n=o[i],this.isRoute(n))return void n.callback(e);t=this.callbackObject.defaultPath||"/",this.goTo(t)},goTo:function(e){window.location.hash=e},isRoute:function(e){return!1},process:function(){this.update(),this.callback&&this.callback(this.data)},update:function(){for(var e,t,n=window.location.hash,o=n.substring(1),i=o.split("?"),r=i[0],i=1<i.length?i[1]:"",s={hash:n,hashPath:o,hashRouteSide:r,hashParametersSide:i,parts:r.split("/").filter(function(e){return!!e}),parameters:{}},c=0;c<s.parts.length;c++)s.parts[c]=s.parts[c].toType();for(t=i.split("&"),c=0;c<t.length;c++)e=t[c].split("="),s.parameters[e[0]]=2===e.length?e[1].toType():null;this.data=s}}})}("undefined"==typeof window?global:window);